import{_ as T,r as b,o as x,c as f,a as e,w as a,u as t,E as h,b as N,d as C,e as B,f as i,g as _,h as v,i as p,j as d,k as V,l as o,t as u,F,m as j,n as M,p as g}from"./index-fNA8COcA.js";const R={class:"firefly-root"},$={class:"table-container"},A={class:"firefly-amount"},D={key:1},O={__name:"RecentTransactionsView",setup(S){const m=b([]),w=b({}),k=async()=>{try{const r=localStorage.getItem("accounts");if(r){const l=JSON.parse(r);w.value=l.reduce((s,c)=>(s[c.id]=c,s),{})}const n=await N.getTransactions();m.value=Object.values(n).map(l=>({...l,category:l.category_name}))}catch{C.error("加载交易列表失败")}},E=r=>{const n=parseFloat(r.replace(/[^\d.-]/g,""));return isNaN(n)?r:`¥ ${n.toFixed(2)}`},y=r=>{if(!r)return"-";const n=w.value[r];return n?n.name:"-"};return x(()=>{k()}),(r,n)=>{const l=B("el-button");return i(),f("div",R,[e(t(h),{gutter:20,justify:"space-between",align:"middle"},{default:a(()=>[e(t(_),{xs:24,sm:16},{default:a(()=>[e(t(v),{class:"firefly-header",shadow:"hover"},{default:a(()=>n[1]||(n[1]=[p("h1",null,"最近交易记录",-1)])),_:1,__:[1]})]),_:1}),e(t(_),{xs:24,sm:8,class:"button-col"},{default:a(()=>[e(l,{type:"primary",icon:"Back",onClick:n[0]||(n[0]=s=>r.$router.push("/"))},{default:a(()=>n[2]||(n[2]=[d("返回首页")])),_:1,__:[2]})]),_:1})]),_:1}),e(t(h),{gutter:20,class:"firefly-recent-row"},{default:a(()=>[e(t(_),{span:24},{default:a(()=>[e(t(v),{class:"firefly-recent-card"},{default:a(()=>[p("div",$,[e(t(V),{data:m.value,stripe:"",border:"",class:"firefly-table"},{default:a(()=>[e(t(o),{prop:"date",label:"日期",width:"110",align:"center"}),e(t(o),{prop:"description",label:"描述","min-width":"120",align:"center"}),e(t(o),{prop:"amount",label:"金额",width:"100",align:"center"},{default:a(s=>[p("span",A,u(s.row&&s.row.amount?E(s.row.amount):"-"),1)]),_:1}),e(t(o),{prop:"category",label:"分类",width:"100",align:"center"}),e(t(o),{prop:"tags",label:"标签",width:"160",align:"center"},{default:a(s=>[s.row&&s.row.tags?.length?(i(!0),f(F,{key:0},j(s.row.tags,c=>(i(),M(t(g),{key:c,size:"small",class:"mr-5"},{default:a(()=>[d(u(c),1)]),_:2},1024))),128)):(i(),f("span",D,"-"))]),_:1}),e(t(o),{prop:"notes",label:"备注","min-width":"100",align:"center"}),e(t(o),{label:"源账户",width:"120",align:"center"},{default:a(s=>[e(t(g),{type:"danger"},{default:a(()=>[d(u(y(s.row.source_id)),1)]),_:2},1024)]),_:1}),e(t(o),{label:"目的账户",width:"120",align:"center"},{default:a(s=>[e(t(g),{type:"info"},{default:a(()=>[d(u(y(s.row.destination_id)),1)]),_:2},1024)]),_:1})]),_:1},8,["data"])])]),_:1})]),_:1})]),_:1})])}}},I=T(O,[["__scopeId","data-v-7dfff206"]]);export{I as default};
